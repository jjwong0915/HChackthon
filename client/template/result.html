<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>很厲害的專案</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb"
        crossorigin="anonymous">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ"
        crossorigin="anonymous"></script>
</head>

<body>
    <main class="resultmain">
        <div class="tabs-bar">
            <ul class="nav nav-tabs">
                <li class="nav-item">
                    <a class="nav-link active" id="posTab" data-toggle="tab" href="#pos">
                        <i class="fa fa-map-marker" aria-hidden="true"></i>
                        <span>您的位置</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-toggle="tab" href="#medical">
                        <i class="fa fa-h-square" aria-hidden="true"></i>
                        <span style="display:none;">醫院 ({{data.medical.length}})</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-toggle="tab" href="#trash">
                        <i class="fa fa-trash" aria-hidden="true"></i>
                        <span style="display:none;">垃圾車 ({{data.trash.length}})</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" data-toggle="tab" href="#bdx">
                        <i class="fa fa-bolt" aria-hidden="true"></i>
                        <span style="display:none;">變電所 ({{data.bdx.length}})</span>
                    </a>
                </li>
            </ul>
            <form action="/" method="post" class="second-search">
                <input type="text" name="address" placeholder="Search..."></input>
                <button type="submit" class="btn btn-primary">
                    <i class="fa fa-search"></i> 搜尋
                </button>
            </form>
            <form action="/" class="second-search">
                <button type="submit" class="btn btn-primary">
                    <i class="fa fa-home"></i> 首頁
                </button>
            </form>
        </div>
        <div class="tab-split">
            <div class="tab-content">
                <div class="tab-pane fade show active" id="pos">
                    {{#target}}
                    <h2>{{address}}</h2>
                    {{#coordinate}}
                    <h3>{{lat}}</h3>
                    <h3>{{lng}}</h3>
                    {{/coordinate}} {{/target}}
                </div>
                {{#data}}
                <div class="tab-pane fade show" id="medical">
                    <div class="nav flex-column nav-pills">
                        {{#medical}}
                        <a class="nav-link" data-toggle="pill" href="#" lat="{{coordinate.lat}}" lng="{{coordinate.lng}}" distance="{{distance}}">
                            {{data.name}}</a>
                        {{/medical}}
                    </div>
                </div>
                <div class="tab-pane fade" id="trash">
                    <div class="nav flex-column nav-pills">
                        {{#trash}}
                        <a class="nav-link" data-toggle="pill" href="#" lat="{{coordinate.lat}}" lng="{{coordinate.lng}}" distance="{{distance}}">{{data.carNumber}}</a>
                        {{/trash}}
                    </div>
                </div>
                <div class="tab-pane fade" id="bdx">
                    <div class="nav flex-column nav-pills">
                        {{#bdx}}
                        <a class="nav-link" data-toggle="pill" href="#" lat="{{coordinate.lat}}" lng="{{coordinate.lng}}" distance="{{distance}}">{{data.name}}</a>
                        {{/bdx}}
                    </div>
                </div>
                {{/data}}
            </div>
            <div class="detail">
                <iframe id="gmapiframe" width="100%" height="100%" frameborder="0" style="border:0" src="https://www.google.com/maps/embed/v1/place?key=AIzaSyBLHGictosoQqbBFZfQ7N0-Z4YmrlZY9I0&q={{target.coordinate.lat}},{{target.coordinate.lng}}"
                    allowfullscreen>
                </iframe>
            </div>
        </div>
    </main>

</body>
<script>
    $("ul.nav-tabs a").click(function (e) {
        e.preventDefault();
        $(this).tab('show');
        $("ul.nav-tabs span").not('.active').hide();
        $(this).children('span').show();
        if ($(this).attr('id') == 'posTab') {
            $("#gmapiframe").attr('src', 'https://www.google.com/maps/embed/v1/place?key=AIzaSyBLHGictosoQqbBFZfQ7N0-Z4YmrlZY9I0&q={{target.coordinate.lat}},{{target.coordinate.lng}}');
        }
    });
    $("div.nav-pills a").click(function (e) {
        e.preventDefault();
        $("#gmapiframe").attr('src', 'https://www.google.com/maps/embed/v1/place?key=AIzaSyBLHGictosoQqbBFZfQ7N0-Z4YmrlZY9I0&center={{target.coordinate.lat}},{{target.coordinate.lng}}&zoom=14&q=' + $(this).attr('lat') + ',' + $(this).attr('lng'));
    });
</script>

</html>
